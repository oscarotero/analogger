# Analogger

This is a simple [Deno](https://deno.land/) library to consume access logs
generated by nginx/apache and generate reports about visits, sessions, etc.

It's divided in two scopes:

- **Transformers:** to parse, transform and enrich the data from log files.
- **Reporters:** to generate reports of this data.

## Example

```ts
import { read, show, transform } from "https://deno.land/x/analogger/mod.ts";
import * as reports from "https://deno.land/x/analogger/reports.ts";
import * as t from "https://deno.land/x/analogger/transformers.ts";

const logs = read("./access.log"), // Read the log file.

// Step 1: Parse and transform the logs:
const result = await transform(
  logs,
  t.parse(),                             // Parse the data.
  t.filterByExtensions([".html", ""]),   // Filter by .html extensions or not extension at all.
  t.filterByTimeRange(                   // Filter by time range (one year, from 2020 to 2021).
    new Date(2020),
    new Date(2021),
  ),
  t.filter((log) => log.status === 200), // Get only requests generating a 200 status code response.
  t.isBot(),                             // Add the `isBot` property indicating if the request is from a bot (ex: Google).
  t.filter((log) => !log.isBot),         // Discard request from bots
  t.parseUserAgent(),                    // Parse the user-agent info
  t.filter((log) => !!log.browserName),  // Discard request with unknown browsers
  t.sessionId(),                         // Add the `sessionId` property with an autogenerated session id
  t.searchEngine(),                      // Add the `searchEngine` property (google, bing, yahoo...)
  t.socialNetwork(),                     // Add the `socialNetwork` property (facebook, twitter, instagram...)
);

// Step 2: Generate reports with this data.
// For example, the number of sessions by month:
const report = reports.sessions(result, "monthly");

// Step 3: See the report in your browser
await show(report);
```
